[Read in english](./README.md)

# –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–±—ç–∫–µ–Ω–¥-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–µ **—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ Django REST Framework (DRF) –∏ PostgreSQL. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç** –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã `django.contrib.auth` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞.


---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.x**
- **Django**
- **Django REST Framework (DRF)**
- **PostgreSQL**
- **PyJWT** (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤)
- **bcrypt** (–¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π)

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ **–∫–∞—Å—Ç–æ–º–Ω—ã–µ –º–æ–¥–µ–ª–∏**:

### 1. `User`
- `id`: –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á.
- `first_name`, `last_name`, `patronymic`: –ò–º—è, —Ñ–∞–º–∏–ª–∏—è, –æ—Ç—á–µ—Å—Ç–≤–æ.
- `email`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- `password_hash`: –•–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `bcrypt`).
- `is_active`: –§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–¥–ª—è –º—è–≥–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è).
- `created_at`, `updated_at`: –î–∞—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
- `role`: –°—Å—ã–ª–∫–∞ –Ω–∞ `Role` (ForeignKey).

### 2. `Role`
- `id`: –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á.
- `name`: –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `admin`, `user`, `manager`).

### 3. `BusinessElement`
- `id`: –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á.
- `name`: –ù–∞–∑–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–æ–±—ä–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `products`, `orders`, `users`, `access_rules`).

### 4. `AccessRule`
- `id`: –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á.
- `role`: –°—Å—ã–ª–∫–∞ –Ω–∞ `Role` (ForeignKey).
- `business_element`: –°—Å—ã–ª–∫–∞ –Ω–∞ `BusinessElement` (ForeignKey).
- `read_permission`: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —á—Ç–µ–Ω–∏–µ.
- `read_all_permission`: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —á—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
- `create_permission`: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ.
- `update_permission`: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
- `update_all_permission`: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
- `delete_permission`: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
- `delete_all_permission`: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
- **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å**: `(role, business_element)` ‚Äî –∫–∞–∂–¥–∞—è —Ä–æ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –ø—Ä–∞–≤–∏–ª–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–¥–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É.

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** (`POST /api/auth/register/`):
  - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: `first_name`, `last_name`, `patronymic`, `email`, `password`, `password_confirm`.
  - –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π.
  - –•–µ—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å —Å –ø–æ–º–æ—â—å—é `bcrypt`.
  - –°–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ä–æ–ª—å—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `JWT`-—Ç–æ–∫–µ–Ω.

- **–í—Ö–æ–¥** (`POST /api/auth/login/`):
  - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: `email`, `password`.
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä–æ–ª—å.
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `JWT`-—Ç–æ–∫–µ–Ω, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤–µ—Ä–Ω—ã.

- **–í—ã—Ö–æ–¥** (`POST /api/auth/logout/`):
  - –ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —É–¥–∞–ª–∏—Ç—å —Ç–æ–∫–µ–Ω.
  - –°–µ—Ä–≤–µ—Ä –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ (stateless).

- **–ü—Ä–æ—Ñ–∏–ª—å** (`GET`, `PUT`, `DELETE /api/auth/profile/`):
  - `GET`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `PUT`: –û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ (–∏–º—è, —Ñ–∞–º–∏–ª–∏—é –∏ —Ç.–¥.).
  - `DELETE`: –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (`is_active = False`).

---

## üîí –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**:
  - –¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ: `Authorization: Bearer <token>`.
  - –ö–∞—Å—Ç–æ–º–Ω—ã–π `JWTAuthentication` –∏–∑–≤–ª–µ–∫–∞–µ—Ç `user` –∏–∑ —Ç–æ–∫–µ–Ω–∞ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤ `request.user`.

- **–ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**:
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `AccessPermission` –∏ –µ–≥–æ –ø–æ–¥–∫–ª–∞—Å—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `AccessPermissionForProducts`).
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ `role` –∏ `business_element`.
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - `401 Unauthorized`, –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π/–ø—Ä–æ—Å—Ä–æ—á–µ–Ω.
    - `403 Forbidden`, –µ—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.

---

## üß™ Mock-–æ–±—ä–µ–∫—Ç—ã

- `/api/products/`, `/api/orders/` –∏ –¥—Ä—É–≥–∏–µ:
  - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
  - –ó–∞—â–∏—â–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é `@permission_classes([AccessPermissionFor...])`.
  - –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: `GET /api/products/` ‚Üí `[{ "id": 1, "name": "–¢–æ–≤–∞—Ä 1", "owner_id": 7 }]`.

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)

- `GET /api/auth/access-rules/` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞.
- `POST /api/auth/access-rules/` ‚Äî —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ.
- `GET /api/auth/access-rules/{id}/` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –ø–æ ID.
- `PUT /api/auth/access-rules/{id}/` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ.
- `DELETE /api/auth/access-rules/{id}/` ‚Äî —É–¥–∞–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ.

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã `Python`, `PostgreSQL`, `pip`.
2. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
3. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
   ```bash
   python -m venv venv
   source venv/bin/activate  # Linux/macOS
   # –∏–ª–∏
   venv\Scripts\activate     # Windows
   ```

4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
    ```bash
    pip install django djangorestframework psycopg2-binary PyJWT bcrypt python-decouple
    ```

5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª:
    ```env
    SECRET_KEY=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á
    DEBUG=True
    DB_NAME=auth_system
    DB_USER=postgres
    DB_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å
    DB_HOST=localhost
    DB_PORT=5432
    ```

6. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
    ```bash
    python manage.py makemigrations
    python manage.py migrate
    ```

7. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ë–î —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
    ```bash
    python manage.py init_data
    ```

8. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
    ```bash
    python manage.py runserver
    ```

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ 

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: 
    ```bash
    curl -X POST http://127.0.0.1:8000/api/auth/register/ \
    -H "Content-Type: application/json" \
    -d '{
        "first_name": "–¢–µ—Å—Ç",
        "last_name": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
        "email": "test@example.com",
        "password": "testpass123",
        "password_confirm": "testpass123"
    }'
    ```

- –í—Ö–æ–¥:
    ```bash
    curl -X POST http://127.0.0.1:8000/api/auth/login/ \
    -H "Content-Type: application/json" \
    -d '{
        "email": "test@example.com",
        "password": "testpass123"
    }'
    ```

- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è:
    ```bash
    curl -X GET http://127.0.0.1:8000/api/auth/profile/ \
    -H "Authorization: Bearer <—Ç–æ–∫–µ–Ω_–∏–∑_–æ—Ç–≤–µ—Ç–∞_–Ω–∞_–≤—Ö–æ–¥>"
    ```

- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ (mock):
    ```bash
    curl -X GET http://127.0.0.1:8000/api/products/ \
    -H "Authorization: Bearer <—Ç–æ–∫–µ–Ω_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è_—Å_–ø—Ä–∞–≤–æ–º_–Ω–∞_—á—Ç–µ–Ω–∏–µ>"
    ```

- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω):
    ```bash
    curl -X GET http://127.0.0.1:8000/api/auth/access-rules/ \
    -H "Authorization: Bearer <—Ç–æ–∫–µ–Ω_–∞–¥–º–∏–Ω–∞>"
    ```

